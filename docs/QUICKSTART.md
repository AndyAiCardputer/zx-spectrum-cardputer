# üöÄ ZX SPECTRUM EMULATOR - QUICK START

**–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞:** M5Stack Cardputer  
**–í–µ—Ä—Å–∏—è:** 1.0 (Emulator Core - Working!)  
**–î–∞—Ç–∞:** 24 –æ–∫—Ç—è–±—Ä—è 2025

---

## ‚úÖ –ß–¢–û –£–ñ–ï –†–ê–ë–û–¢–ê–ï–¢:

- ‚úÖ Z80 CPU —ç–º—É–ª—è—Ü–∏—è (3.5 MHz)
- ‚úÖ 16KB ROM (Sinclair 48K)
- ‚úÖ 48KB RAM
- ‚úÖ Interrupt Mode 1 (50 Hz)
- ‚úÖ EI/DI/HALT –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏
- ‚úÖ 50 FPS stable timing

**–°—Ç–∞—Ç—É—Å:** –≠–º—É–ª—è—Ç–æ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç, ROM –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è, INT –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è!

---

## üì¶ –¢–†–ï–ë–û–í–ê–ù–ò–Ø:

- **Hardware:** M5Stack Cardputer
- **Software:** PlatformIO
- **USB:** –ö–∞–±–µ–ª—å USB-C

---

## üõ†Ô∏è –£–°–¢–ê–ù–û–í–ö–ê:

### 1. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ Cardputer –∫ –∫–æ–º–ø—å—é—Ç–µ—Ä—É

### 2. –°–æ–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç:
```bash
cd /Users/a15/Desktop/cardputer/zx_rainbow_cardputer
pio run --target upload
```

### 3. –û—Ç–∫—Ä–æ–π—Ç–µ –º–æ–Ω–∏—Ç–æ—Ä:
```bash
pio device monitor --baud 115200
```

–ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `screen`:
```bash
screen /dev/cu.usbmodem14401 115200
```

---

## üìä –û–ñ–ò–î–ê–ï–ú–´–ô –í–´–í–û–î:

```
========================================
   ZX SPECTRUM EMULATOR STARTING
========================================

Free heap: 359248 bytes
ROM loaded: 16384 bytes
=== ROM VERIFICATION ===
ROM[0x0000] = 0xF3 (expect 0xF3 = DI)
ROM[0x0001] = 0xAF (expect 0xAF = XOR A)
‚úÖ ROM verified: correct ZX Spectrum 48K ROM

=== EMULATOR READY ===
Z80 PC: 0x0000 (should be 0x0000)
Z80 SP: 0xFFFF
Z80 IM: 0 (should be 0)
Z80 IFF1: 0 (should be 0)

Starting emulation...

üéØ INT #81: PC=0x0E5C‚Üí0x0038 IM=1 IFF1=1‚Üí0 ‚úÖ
‚ú® IM=1 –æ–±–Ω–∞—Ä—É–∂–µ–Ω –Ω–∞ frame #81!

FPS: 50.00 | INT: 50.00/s | PC: 0x10B4 | IM: 1 | IFF1: 1 ‚úÖ
```

**–ï—Å–ª–∏ –≤–∏–¥–∏—Ç–µ —Ç–∞–∫–æ–π –≤—ã–≤–æ–¥ ‚Äî —ç–º—É–ª—è—Ç–æ—Ä –†–ê–ë–û–¢–ê–ï–¢!** üéâ

---

## üîç –ü–†–û–í–ï–†–ö–ê –†–ê–ë–û–¢–û–°–ü–û–°–û–ë–ù–û–°–¢–ò:

### ‚úÖ –ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—Ö–∞:

1. **ROM verified:** `‚úÖ ROM verified: correct ZX Spectrum 48K ROM`
2. **FPS:** 49.95-50.00
3. **INT rate:** 49.95-50.00/s
4. **IM:** 1 (–ø–æ—Å–ª–µ ~81 frames)
5. **IFF1:** 1 (–≤ HUD, –º–µ–∂–¥—É –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏—è–º–∏)
6. **PC:** –º–µ–Ω—è–µ—Ç—Å—è (–Ω–µ –∑–∞—Å—Ç—Ä–µ–≤–∞–µ—Ç –Ω–∞ 0x0038 –∏–ª–∏ 0x0000)

### ‚ùå –ü—Ä–∏–∑–Ω–∞–∫–∏ –ø—Ä–æ–±–ª–µ–º:

- `üî¥ FATAL: ROM signature mismatch` ‚Üí –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π ROM
- `PC: 0x0000` –ø–æ—Å—Ç–æ—è–Ω–Ω–æ ‚Üí CPU –Ω–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è
- `IM: 0` –ø–æ—Å—Ç–æ—è–Ω–Ω–æ ‚Üí ROM –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–ª—Å—è
- `IFF1: 0` –ø–æ—Å—Ç–æ—è–Ω–Ω–æ ‚Üí EI-delay –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

---

## üêõ TROUBLESHOOTING:

### –ü—Ä–æ–±–ª–µ–º–∞: Device not configured
```
Disconnected (read failed: [Errno 6] Device not configured)
```

**–†–µ—à–µ–Ω–∏–µ:**
1. –ù–∞–∂–º–∏—Ç–µ **RESET** –Ω–∞ Cardputer
2. –ë—ã—Å—Ç—Ä–æ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–∏—Ç–µ –º–æ–Ω–∏—Ç–æ—Ä
3. –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `screen` –≤–º–µ—Å—Ç–æ `pio device monitor`

---

### –ü—Ä–æ–±–ª–µ–º–∞: Upload failed
```
A fatal error occurred: Failed to connect to ESP32
```

**–†–µ—à–µ–Ω–∏–µ:**
1. –£–¥–µ—Ä–∂–∏–≤–∞–π—Ç–µ **G0** –∫–Ω–æ–ø–∫—É –ø—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏ USB
2. –ò–ª–∏ –Ω–∞–∂–º–∏—Ç–µ **RESET** –≤–æ –≤—Ä–µ–º—è upload
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ USB –∫–∞–±–µ–ª—å (–¥–æ–ª–∂–µ–Ω –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ, –Ω–µ —Ç–æ–ª—å–∫–æ –ø–∏—Ç–∞–Ω–∏–µ)

---

### –ü—Ä–æ–±–ª–µ–º–∞: Compilation failed
```
fatal error: 48k_rom.h: No such file or directory
```

**–†–µ—à–µ–Ω–∏–µ:**
–£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ —Ñ–∞–π–ª `src/spectrum/48k_rom.h` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏ —Å–æ–¥–µ—Ä–∂–∏—Ç:
```cpp
const unsigned char gb_rom_0_sinclair_48k[]={
0xF3,0xAF,0x11,0xFF,0xFF,0xC3,0xCB,0x11,...
```

---

## üìÅ –°–¢–†–£–ö–¢–£–†–ê –§–ê–ô–õ–û–í:

```
zx_rainbow_cardputer/
‚îú‚îÄ‚îÄ platformio.ini              # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ main.cpp                # –ì–ª–∞–≤–Ω—ã–π —Ñ–∞–π–ª
‚îÇ   ‚îú‚îÄ‚îÄ spectrum/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ spectrum_mini.h     # ZX Spectrum –∫–ª–∞—Å—Å
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ spectrum_mini.cpp   # –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —ç–º—É–ª—è—Ç–æ—Ä–∞
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ 48k_rom.h           # ROM (16KB)
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ memory.h            # –ü–∞–º—è—Ç—å (ROM+RAM)
‚îÇ   ‚îî‚îÄ‚îÄ z80/
‚îÇ       ‚îú‚îÄ‚îÄ z80.h               # Z80 —Ä–µ–≥–∏—Å—Ç—Ä—ã
‚îÇ       ‚îú‚îÄ‚îÄ z80.cpp             # Z80 —ç–º—É–ª—è—Ü–∏—è
‚îÇ       ‚îú‚îÄ‚îÄ macros.h            # –ú–∞–∫—Ä–æ—Å—ã
‚îÇ       ‚îî‚îÄ‚îÄ opcodes.h           # –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ Z80
‚îî‚îÄ‚îÄ SUCCESS_REPORT_V1.0.md      # –≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç!
```

---

## üéØ –°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò:

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ —ç–º—É–ª—è—Ç–æ—Ä–∞:

1. **–£–±—Ä–∞—Ç—å debug –ª–æ–≥–∏** (INT #0-100) ‚Üí —á–∏—Å—Ç—ã–π –≤—ã–≤–æ–¥
2. **–î–æ–±–∞–≤–∏—Ç—å —ç–∫—Ä–∞–Ω** ‚Üí —É–≤–∏–¥–µ—Ç—å VRAM
3. **–î–æ–±–∞–≤–∏—Ç—å –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É** ‚Üí –≤–≤–æ–¥–∏—Ç—å –∫–æ–º–∞–Ω–¥—ã
4. **–ó–∞–≥—Ä—É–∑–∏—Ç—å –∏–≥—Ä—É** ‚Üí SABOTEUR! üéÆ

---

## üìö –î–û–ö–£–ú–ï–ù–¢–ê–¶–ò–Ø:

- `SUCCESS_REPORT_V1.0.md` - –ü–æ–ª–Ω—ã–π –æ—Ç—á—ë—Ç –æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è—Ö
- `TECHNICAL_DETAILS.md` - –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
- `SUMMARY_RU.md` - –†–µ–∑—é–º–µ –ø—Ä–æ–µ–∫—Ç–∞ (—Å—Ç–∞—Ä–æ–µ)

---

## üí° –ü–û–õ–ï–ó–ù–´–ï –ö–û–ú–ê–ù–î–´:

### –°–±–æ—Ä–∫–∞ –±–µ–∑ –∑–∞–≥—Ä—É–∑–∫–∏:
```bash
pio run
```

### –¢–æ–ª—å–∫–æ –∑–∞–≥—Ä—É–∑–∫–∞:
```bash
pio run --target upload
```

### –û—á–∏—Å—Ç–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞:
```bash
pio run --target clean
```

### –õ–æ–≥–∏ –≤ —Ñ–∞–π–ª:
```bash
pio device monitor --baud 115200 > logs.txt
```

---

## üéâ –£–°–ü–ï–•!

–ï—Å–ª–∏ –≤—ã –≤–∏–¥–∏—Ç–µ:
```
FPS: 50.00 | INT: 50.00/s | PC: 0x10B4 | IM: 1 | IFF1: 1 ‚úÖ
```

**–ü–û–ó–î–†–ê–í–õ–Ø–ï–ú!** –£ –≤–∞—Å —Ä–∞–±–æ—Ç–∞–µ—Ç ZX Spectrum —ç–º—É–ª—è—Ç–æ—Ä –Ω–∞ Cardputer! üöÄ

---

**–í–æ–ø—Ä–æ—Å—ã?** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `SUCCESS_REPORT_V1.0.md` –¥–ª—è –¥–µ—Ç–∞–ª–µ–π.
